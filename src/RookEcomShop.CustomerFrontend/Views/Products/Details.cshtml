@using RookEcomShop.ViewModels.Product
@model ProductVM;

@{
  var product = @Model;
  var productImgUrl = Model.ImgUrls.Count() > 0 ? "https://localhost:7181/api/v1/upload-image?imageName=" +
  Model.ImgUrls.FirstOrDefault() :
  "https://tailwindui.com/img/ecommerce-images/product-page-02-featured-product-shot.jpg";

  Layout = "~/Views/Shared/Layouts/_LayoutNoSidebar.cshtml";
}

@section PageScripts {
  <script type="text/javascript">
    // <reference path='~/Scripts/jquery-3.7.1.js' />;
    var accessToken = "@ViewBag.AccessToken";
    $("#add-to-cart-btn").on("click", function () {
      $.ajax({
        url: '/cart/add-to-cart',
        type: 'POST',
        headers: {
          'X-Requested-With': 'XMLHttpRequest',
          'Authorization': 'Bearer ' + accessToken,
          "Access-Control-Allow-Origin": "*", // Required for CORS
        },
        dataType: 'json',
        data: {
          productId: @Model.Id,
          quantity: 1
        },
        success: function (data) {
          console.log('Success:', data);
          // Handle the response data here
        },
        error: function (error) {
          console.log('Error:', error);
          // Handle the error here
        }
      });
    })
  </script>
  <script src="~/js/product-detail.js"></script>

}

<div class="bg-white">
  <div class="pt-6">
    <nav aria-label="Breadcrumb">
      <ol role="list" class="mx-auto flex max-w-2xl items-center space-x-2 px-4 sm:px-6 lg:max-w-7xl lg:px-8">
        @* <li>
        <div class="flex items-center">
        <a href="#" class="mr-2 text-sm font-medium text-gray-900">Men</a>
        <svg width="16" height="20" viewBox="0 0 16 20" fill="currentColor" aria-hidden="true" class="h-5 w-4
        text-gray-300">
        <path d="M5.697 4.34L8.98 16.532h1.327L7.025 4.341H5.697z" />
        </svg>
        </div>
        </li> *@
        <li>
          <div class="flex items-center">
            <a href="#" class="mr-2 text-sm font-medium text-gray-900">@product.Category.Name</a>
            <svg width="16" height="20" viewBox="0 0 16 20" fill="currentColor" aria-hidden="true"
              class="h-5 w-4 text-gray-300">
              <path d="M5.697 4.34L8.98 16.532h1.327L7.025 4.341H5.697z" />
            </svg>
          </div>
        </li>

        <li class="text-sm">
          <a href="#" aria-current="page" class="font-medium text-gray-500 hover:text-gray-600">@product.Name</a>
        </li>
      </ol>
    </nav>

    <!-- Image gallery -->
    <div class="mx-auto mt-6 max-w-2xl sm:px-6 lg:grid lg:max-w-7xl lg:grid-cols-3 lg:gap-x-8 lg:px-8">
      <div class="aspect-h-4 aspect-w-3 hidden overflow-hidden rounded-lg lg:block">
        <img src="https://tailwindui.com/img/ecommerce-images/product-page-02-secondary-product-shot.jpg"
          alt="Two each of gray, white, and black shirts laying flat." class="h-full w-full object-cover object-center">
      </div>
      <div class="hidden lg:grid lg:grid-cols-1 lg:gap-y-8">
        <div class="aspect-h-2 aspect-w-3 overflow-hidden rounded-lg">
          <img src="https://tailwindui.com/img/ecommerce-images/product-page-02-tertiary-product-shot-01.jpg"
            alt="Model wearing plain black basic tee." class="h-full w-full object-cover object-center">
        </div>
        <div class="aspect-h-2 aspect-w-3 overflow-hidden rounded-lg">
          <img src="https://tailwindui.com/img/ecommerce-images/product-page-02-tertiary-product-shot-02.jpg"
            alt="Model wearing plain gray basic tee." class="h-full w-full object-cover object-center">
        </div>
      </div>
      <div
        class="aspect-h-5 aspect-w-4 lg:aspect-h-4 lg:aspect-w-3 border border-gray-200 sm:overflow-hidden sm:rounded-lg">
        <img src="@productImgUrl" alt="Model wearing plain white basic tee."
          class="h-full w-full object-cover object-center">
      </div>
    </div>

    <!-- Product info -->
    <partial name="Partials/_ProductInfo" model="product"></partial>
  </div>
</div>


<a href="@Url.Action("Index", "Home")">Back to Home</a>